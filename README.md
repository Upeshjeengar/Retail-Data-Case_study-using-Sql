# Retail-Data-Case_study-using-Sql
 Retail data includes information on sales, inventory, customer behavior, and transactions. It helps businesses track product performance, manage stock levels, and understand customer preferences. Analyzing retail data with tools like SQL can optimize operations, boost sales, and enhance customer satisfaction.


# Retail Data Case Study Using SQL

This repository contains a series of SQL queries aimed at analyzing and extracting insights from a retail dataset. The data encompasses various aspects of retail operations, including customer information, product categories, and transaction details. The analysis was performed using SQL to answer business-related questions and provide actionable insights. Below is a detailed explanation of each SQL query used in the project.

## Table of Contents
1. [Database Structure](#database-structure)
2. [Data Preparation and Understanding](#data-preparation-and-understanding)
   - 1. [Total Number of Rows in Each Table](#01-total-number-of-rows-in-each-table)
   - 2. [Total Number of Transactions with Returns](#02-total-number-of-transactions-with-returns)
   - 3. [Date Format Correction](#03-date-format-correction)
   - 4. [Transaction Data Time Range](#04-transaction-data-time-range)
   - 5. [Product Category of Sub-category "DIY"](#05-product-category-of-sub-category-diy)
3. [Data Analysis](#data-analysis)
   - 1. [Most Frequently Used Transaction Channel](#01-most-frequently-used-transaction-channel)
   - 2. [Gender Count in Customer Database](#02-gender-count-in-customer-database)
   - 3. [City with Maximum Customers](#03-city-with-maximum-customers)
   - 4. [Sub-categories under Books Category](#04-sub-categories-under-books-category)
   - 5. [Maximum Quantity of Products Ordered](#05-maximum-quantity-of-products-ordered)
   - 6. [Net Revenue Generated in Electronics and Books Categories](#06-net-revenue-generated-in-electronics-and-books-categories)
   - 7. [Customers with More than 10 Transactions](#07-customers-with-more-than-10-transactions)
   - 8. [Combined Revenue from Electronics and Clothing in Flagship Stores](#08-combined-revenue-from-electronics-and-clothing-in-flagship-stores)
   - 9. [Revenue Generated from Male Customers in Electronics Category](#09-revenue-generated-from-male-customers-in-electronics-category)
   - 10. [Percentage of Sales and Returns by Sub-category](#10-percentage-of-sales-and-returns-by-sub-category)
   - 11. [Net Revenue Generated by Customers Aged 25-35 Years](#11-net-revenue-generated-by-customers-aged-25-35-years)
   - 12. [Product Category with Maximum Returns in Last 3 Months](#12-product-category-with-maximum-returns-in-last-3-months)
   - 13. [Store-Type with Maximum Sales and Quantity Sold](#13-store-type-with-maximum-sales-and-quantity-sold)
   - 14. [Categories with Above-Average Revenue](#14-categories-with-above-average-revenue)
   - 15. [Average and Total Revenue by Sub-category in Top 5 Categories](#15-average-and-total-revenue-by-sub-category-in-top-5-categories)

## Database Structure

The database `Business_Context` consists of the following tables:

1. `Customer`: Contains information about customers, including their ID, name, gender, date of birth, and city.
2. `prod_cat_info`: Holds data about product categories and sub-categories.
3. `Transactions`: Records details of each transaction, including transaction ID, customer ID, product category, sub-category, store type, transaction date, quantity, and total amount.

## Data Preparation and Understanding

### 01. Total Number of Rows in Each Table

This query provides the total number of rows in each of the three tables (`Customer`, `prod_cat_info`, `Transactions`), helping to understand the scale of data available for analysis.

```sql
select
    (select count(*) from dbo.Customer) as Customer_row_count,
    (select count(*) from dbo.prod_cat_info) as prod_cat_info_row_count,
    (select count(*) from dbo.Transactions) as Transactions_row_count;
```

### 02. Total Number of Transactions with Returns

This query counts the number of transactions that involved a return (indicated by negative values in the `total_amt` field).

```sql
select count(*) AS total_returned_transactions
  FROM dbo.Transactions
  WHERE  [total_amt] like '-%';
```

### 03. Date Format Correction

The following queries format the date fields in the `Customer` and `Transactions` tables to `dd-MM-yyyy` format.

```sql
select FORMAT(DOB,'dd-MM-yyyy') as formatted_date from [dbo].[Customer];
select FORMAT(tran_date,'dd-MM-yyyy') as formatted_date from [dbo].[Transactions];
```

### 04. Transaction Data Time Range

This query calculates the range of transaction dates in terms of days, months, and years.

```sql
select 
datediff(day,min(tran_date),max(tran_date)) as days,
datediff(month,min(tran_date),max(tran_date)) as months,
datediff(year,min(tran_date),max(tran_date)) as years
from [dbo].[Transactions];
```

### 05. Product Category of Sub-category "DIY"

This query identifies the product category to which the sub-category "DIY" belongs.

```sql
select [prod_cat] FROM [dbo].[prod_cat_info] where [prod_subcat] = 'DIY';
```

## Data Analysis

### 01. Most Frequently Used Transaction Channel

This query determines the most frequently used channel for transactions by counting occurrences in the `Store_type` field.

```sql
select top 1 [Store_type] ,count([Store_type]) as channel from [dbo].[Transactions]
group by [Store_type]
ORDER BY channel desc;
```

### 02. Gender Count in Customer Database

This query counts the number of male and female customers in the database.

```sql
select Gender,count(Gender)as count from [dbo].[Customer] where Gender in ('M','F')
group by Gender;
```

### 03. City with Maximum Customers

This query identifies the city with the maximum number of customers.

```sql
select top 1 [city_code],count([city_code]) as no_of_cus from [dbo].[Customer]
group by [city_code]
order by no_of_cus desc;
```

### 04. Sub-categories under Books Category

This query counts the number of sub-categories under the "Books" category.

```sql
select [prod_cat],count([prod_subcat]) as no_subcat from [dbo].[prod_cat_info] where [prod_cat] = 'Books' 
group by [prod_cat];
```

### 05. Maximum Quantity of Products Ordered

This query identifies the maximum quantity of products ever ordered in a single transaction.

```sql
select max([Qty]) as maximum_qty
from [dbo].[Transactions];
```

### 06. Net Revenue Generated in Electronics and Books Categories

This query calculates the net total revenue generated in the "Electronics" and "Books" categories.

```sql
select [prod_cat],sum([total_amt]) as tot_revenue 
from [dbo].[prod_cat_info] p
inner join [dbo].[Transactions] t on p.[prod_cat_code] = t.[prod_cat_code] and t.prod_subcat_code=p.prod_sub_cat_code
where [prod_cat] in ('Electronics','Books')
group by [prod_cat];
```

### 07. Customers with More than 10 Transactions

This query counts the number of customers who have made more than 10 transactions, excluding returns.

```sql
select count([customer_Id]) as cust_count
from [dbo].[Customer] where [customer_Id] in 
( select [customer_Id] from [dbo].[Transactions] t
inner join [dbo].[Customer] c on t.cust_id=c.customer_Id
where [total_amt] not like'-%'
group by [customer_Id]
having count([transaction_id]) > 10);
```

### 08. Combined Revenue from Electronics and Clothing in Flagship Stores

This query calculates the combined revenue generated from the "Electronics" and "Clothing" categories in "Flagship stores".

```sql
SELECT SUM(total_amt) AS CombinedRevenue
FROM Transactions t
inner join [dbo].[prod_cat_info] p on t.[prod_cat_code]= p.prod_cat_code and t.prod_subcat_code=p.prod_sub_cat_code
WHERE [prod_cat] IN ('Electronics', 'Clothing') AND store_type = 'Flagship store';
```

### 09. Revenue Generated from Male Customers in Electronics Category

This query calculates the total revenue generated from male customers in the "Electronics" category, grouped by product sub-category.

```sql
SELECT [Gender],p.[prod_cat], p.[prod_subcat],
       SUM(total_amt) AS TotalRevenue_Male
FROM Transactions t
inner JOIN [dbo].[prod_cat_info] p ON t.[prod_cat_code] = p.[prod_cat_code] and t.[prod_subcat_code] = p.[prod_sub_cat_code]
inner JOIN [dbo].[Customer] c ON t.[cust_id] = c.[customer_Id]
WHERE p.[prod_cat] = 'Electronics' and Gender =  'M'
GROUP BY [Gender],p.[prod_cat], p.[prod_subcat];
```

### 10. Percentage of Sales and Returns by Sub-category

This query calculates the percentage of sales and returns by product sub-category, displaying only the top 5 sub-categories in terms of sales.

```sql
select top 5 p.[prod_subcat],(sum([total_amt])/(select sum([total_amt])
from [dbo].[Transactions]))*100 as percentage_of_sales,
(count(case when [total_amt]<0 then [total_amt] else

 null
end)/sum([total_amt]))*100 as percent_of_return
from [dbo].[Transactions] t
inner join [dbo].[prod_cat_info] p on t.[prod_subcat_code]=p.[prod_sub_cat_code] and t.prod_cat_code = p.prod_cat_code 
group by p.[prod_subcat]
order by sum([total_amt]) desc;
```

### 11. Net Revenue Generated by Customers Aged 25-35 Years

This query calculates the net total revenue generated by customers aged between 25 and 35 years in the last 30 days of transactions.

```sql
SELECT [cust_id],sum([total_amt]) AS TOTAL_REVENUE
FROM [dbo].[Transactions]
where [cust_id] in 
(  SELECT [customer_Id] FROM [dbo].[Customer]
WHERE DATEDIFF(YEAR,CONVERT(DATE,[DOB],103),GETDATE()) between 25 and 35
and CONVERT(date,[tran_date],103) between DATEADD(day,-30, (select max(convert(DATE,[tran_date],103)) FROM [dbo].[Transactions]))
AND (select max(convert(DATE,[tran_date],103)) FROM [dbo].[Transactions]))
GROUP BY [cust_id];
```

### 12. Product Category with Maximum Returns in Last 3 Months

This query identifies the product category that has seen the maximum value of returns in the last 3 months of transactions.

```sql
select top 1 
prod_cat,sum(total_amt) as totalamt
from
prod_cat_info p
inner join  Transactions t on t.prod_cat_code = p.prod_cat_code and t.prod_subcat_code=p.prod_sub_cat_code
where [total_amt] <0 and CONVERT(date,tran_date,103) between DATEADD(month,-3, (select max(convert(date,tran_date,103)) FROM Transactions))
AND (select max(convert(date,tran_date,103)) FROM Transactions)
group by
prod_cat
order by totalamt desc;
```

### 13. Store-Type with Maximum Sales and Quantity Sold

This query determines which store-type sells the maximum products by sales amount and by quantity sold.

```sql
select top 1 [Store_type], sum([total_amt]) as sales_amt,sum([Qty]) as qty
from [dbo].[Transactions]
group by [Store_type]
order by [Qty] desc;
```

### 14. Categories with Above-Average Revenue

This query identifies the product categories for which the average revenue is above the overall average.

```sql
select [prod_cat],avg([total_amt]) as total_rev
from [dbo].[Transactions] t
inner join [dbo].[prod_cat_info] p on t.prod_subcat_code=p.prod_sub_cat_code and t.prod_cat_code = p.prod_cat_code
group by [prod_cat]
having avg([total_amt]) > (select avg([total_amt]) from [dbo].[Transactions]);
```

### 15. Average and Total Revenue by Sub-category in Top 5 Categories

This query calculates the average and total revenue by each sub-category for the top 5 categories in terms of quantity sold.

```sql
SELECT top 5 [prod_cat], [prod_subcat],
avg([total_amt]) as avg_revenue,
SUM([total_amt]) AS total_quantity_sold
FROM [dbo].[Transactions] t
inner join [dbo].[prod_cat_info] p on t.[prod_cat_code]=p.[prod_cat_code] and t.prod_subcat_code=p.prod_sub_cat_code
where [prod_cat] in
( select top 5 [prod_cat] from [dbo].[Transactions] t
inner join [dbo].[prod_cat_info] p on t.[prod_cat_code]=p.[prod_cat_code] and t.prod_subcat_code=p.prod_sub_cat_code
group by [prod_cat]
order by sum([Qty]) desc)
group by [prod_cat], [prod_subcat];
```

## Conclusion

This SQL project provides a comprehensive analysis of a retail dataset, offering insights into customer behavior, sales trends, and product performance. By answering specific business questions, this analysis can help optimize retail operations, enhance customer satisfaction, and drive sales growth. Feel free to explore the SQL queries and adapt them to your datasets for similar analyses.

## Author

**Upesh Jeengar**

[GitHub Profile](https://github.com/upeshjeengar)

---

This `README` document serves as a guide to understanding and navigating the SQL queries and their respective purposes in this retail data analysis project.